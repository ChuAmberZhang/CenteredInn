var hotelControllers=angular.module("hotelControllers",["firebase"]),config={apiKey:"AIzaSyDNFewR2r5GX-yMHSp76iqYLZe1l8QlT2k",authDomain:"centeredinn.firebaseapp.com",databaseURL:"https://centeredinn.firebaseio.com",storageBucket:"centeredinn.appspot.com",messagingSenderId:"530961530635"};firebase.initializeApp(config),hotelControllers.controller("SettingsController",["$scope","$window","$location","$firebaseAuth","CommonData",function($scope,$window,$location,$firebaseAuth,CommonData){$scope.loggedIn=!0,$scope.isLogin=!0,$scope.failed=!1,$scope.switchMessage="New user? Sign up here!",$scope.buttonLabel="Login",$scope.search={city:"",start:"",end:""},$scope.login={email:"",pwd:""},$scope.signup={name:"",email:"",pwd:""},$scope.fail={message:""},$scope["switch"]=function(e){$scope.isLogin?($scope.switchMessage="Already a user? Login here!",$scope.buttonLabel="Sign Up"):($scope.switchMessage="New user? Sign up here!",$scope.buttonLabel="Login"),$scope.isLogin=!$scope.isLogin},$scope.login=function(e){if($scope.authObj=$firebaseAuth(),$scope.isLogin){var email=$scope.login.email,password=$scope.login.pwd;$scope.authObj.$signInWithEmailAndPassword(email,password).then(function(firebaseUser){console.log("Signed in as:",firebaseUser.uid),$scope.loggedIn=!0,$window.sessionStorage.setItem("uid",firebaseUser.uid)})["catch"](function(error){console.error("Authentication failed:",error),$scope.failed=!0,$scope.fail.message=error.message})}else{var username=$scope.signup.name,email=$scope.signup.email,password=$scope.signup.pwd;$scope.authObj.$createUserWithEmailAndPassword(email,password).then(function(firebaseUser){console.log("User "+firebaseUser.uid+" "+username+" created successfully!"),$scope.loggedIn=!0,$window.sessionStorage.setItem("uid",firebaseUser.uid)})["catch"](function(error){console.error("Error: ",error),$scope.failed=!0,$scope.fail.message=error.message})}},$scope.searchSpots=function(e){var city=$scope.search.city;CommonData.setCity(city),CommonData.setStartDate($scope.search.start),CommonData.setEndDate($scope.search.end),$location.path("/main")}}]),hotelControllers.controller("MainController",["$scope","Amadeus","$window","CommonData",function($scope,Amadeus,$window,CommonData){function refresh(hotelIcon){deleteMarkers();for(var i=0;i<$scope.spots.length;i++){console.log($scope.spots[i]);var icon;icon=1==hotelIcon?"../media/hotel.png":"../media/spot.png",addMarker($scope.spots[i],icon)}showMarkers()}function addMarker(spot,iconLink){var marker=new google.maps.Marker({position:{lat:spot.location.latitude,lng:spot.location.longitude},map:map,icon:iconLink});jQuery(document).ready(function($){marker.addListener("mouseover",function($event){var str="<div style='padding:10px;'><h6>"+spot.title+"</h6><img class='col-sm-6' src='"+spot.main_image+"' alt='https://pbs.twimg.com/profile_images/600060188872155136/st4Sp6Aw.jpg' style='width:80px;height:auto;margin-bottom: 20px'></div>";infowindow.setContent(str),infowindow.open(map,marker);var list_item=document.getElementById("geo"+spot.geoname_id);$(list_item).css("background-color","#a8c6e4")}),marker.addListener("mouseout",function($event){infowindow.close();var list_item=document.getElementById("geo"+spot.geoname_id);$(list_item).css("background-color","white")})}),$scope.markers.push(marker)}function setMapOnAll(map){for(var i=0;i<$scope.markers.length;i++)$scope.markers[i].setMap(map)}function clearMarkers(){setMapOnAll(null)}function showMarkers(){setMapOnAll(map)}function deleteMarkers(){clearMarkers(),$scope.markers.length=0}$scope.markers=[],$scope.currCity,$window.map=new google.maps.Map(document.getElementById("map"),{center:{lat:40.1147412,lng:-88.3471495},zoom:8}),$scope.spots,$scope.hotels;var infowindow=new google.maps.InfoWindow({content:null,disableAutoPan:!0});CommonData.getCity(),CommonData.getStartDate(),CommonData.getEndDate();$scope.getSpots=function(city,cate){console.log(city,cate),Amadeus.getSpotsAPI(city,cate).success(function(data){$scope.spots=data.points_of_interest,$scope.currCity=data.current_city,$window.map=new google.maps.Map(document.getElementById("map"),{center:{lat:$scope.currCity.location.latitude,lng:$scope.currCity.location.longitude},zoom:12}),refresh(!1)}).error(function(data){$scope.spots=data.message})},$("a").on("click",function(e){console.log($(this).parents())}),$scope.expand=function(){},window.onload=function(){$(".accordion").foundation()}}]);